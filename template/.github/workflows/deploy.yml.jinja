# =============================================================================
# GitOps Deployment Workflow (disabled - enable when ready)
# =============================================================================
# To enable:
# 1. Uncomment the workflow below
# 2. Set up GitHub secrets: VPS_HOST, VPS_USER, VPS_SSH_KEY, WATCHTOWER_TOKEN
# 3. Set up GitHub variables: DEPLOY_METHOD (ssh or watchtower)
# =============================================================================

name: Deploy (Disabled)

on:
  workflow_dispatch:
    inputs:
      placeholder:
        description: "This workflow is disabled"
        required: false
        default: "true"

jobs:
  disabled:
    runs-on: ubuntu-latest
    steps:
      - name: Workflow Disabled
        run: |
          echo "This workflow is currently disabled."
          echo "See comments in deploy.yml to enable it."

# =============================================================================
# ACTUAL DEPLOYMENT WORKFLOW (uncomment to enable)
# =============================================================================
{% raw %}
# name: Deploy
#
# on:
#   push:
#     branches:
#       - master
#     paths:
#       - "deploy/**"
#   workflow_dispatch:
#     inputs:
#       environment:
#         description: "Environment to deploy"
#         required: true
#         default: "dev"
#         type: choice
#         options:
#           - dev
#           - prod
#
# env:
#   DEPLOY_ENV: ${{ github.event.inputs.environment || 'dev' }}
#
# jobs:
#   deploy:
#     runs-on: ubuntu-latest
#     environment: ${{ github.event.inputs.environment || 'dev' }}
#
#     steps:
#       - name: Checkout
#         uses: actions/checkout@v4
#
#       - name: Deploy via SSH
#         uses: appleboy/ssh-action@v1.0.3
#         with:
#           host: ${{ secrets.VPS_HOST }}
#           username: ${{ secrets.VPS_USER }}
#           key: ${{ secrets.VPS_SSH_KEY }}
#           script: |
#             cd /opt/{% endraw %}{{ project_name }}{% raw %}/repo
#             git pull origin master
#             cp deploy/docker-compose.*.yml /opt/{% endraw %}{{ project_name }}{% raw %}/
#             cp -r deploy/ops /opt/{% endraw %}{{ project_name }}{% raw %}/
#             cp -r deploy/app /opt/{% endraw %}{{ project_name }}{% raw %}/
#             cd /opt/{% endraw %}{{ project_name }}{% raw %}
#             docker compose \
#               -f docker-compose.ops.yml \
#               -f ops/overlays/base/docker-compose.yml \
#               -f ops/overlays/${{ env.DEPLOY_ENV }}/docker-compose.yml \
#               -f docker-compose.app.yml \
#               -f app/overlays/base/docker-compose.yml \
#               -f app/overlays/${{ env.DEPLOY_ENV }}/docker-compose.yml \
#               --profile caddy --profile promtail --profile watchtower \
#               up -d
#
#       - name: Summary
#         run: |
#           echo "## Deployment Complete" >> $GITHUB_STEP_SUMMARY
#           echo "- **Environment:** ${{ env.DEPLOY_ENV }}" >> $GITHUB_STEP_SUMMARY
#           echo "- **Commit:** ${{ github.sha }}" >> $GITHUB_STEP_SUMMARY
{% endraw %}
