# =============================================================================
# APP OVERLAY - PROD
# =============================================================================
# Prod-specific overrides for application service.
# =============================================================================

services:
  {{ service_name }}:
    image: {{ docker_image }}:latest
    env_file:
      - app/overlays/prod/.env
{% if vault %}
    volumes:
      - ./ops/configs/vault/entrypoint.sh:/entrypoint.sh:ro
    entrypoint: ["/entrypoint.sh"]
{% endif %}
    command: ["{{ app_command.split(' ') | join('", "') }}"]
{% if vault_agent %}
    depends_on:
      - vault-agent
{% endif %}
{% if watchtower %}
    labels:
      - "com.centurylinklabs.watchtower.scope=prod"
{% endif %}
