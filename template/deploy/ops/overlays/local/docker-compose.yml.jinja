# =============================================================================
# OPS OVERLAY - LOCAL
# =============================================================================
# Local-specific overrides for ops services.
# =============================================================================

services:
{% if caddy %}
  caddy:
    env_file:
      - ops/overlays/local/.env
{% endif %}
{% if traefik %}

  traefik:
    env_file:
      - ops/overlays/local/.env
{% endif %}
{% if grafana %}

  grafana:
    env_file:
      - ops/overlays/local/.env
{% endif %}
{% if vault_agent %}

  vault-agent:
    environment:
      - VAULT_SECRET_PATH={{ service_name }}
      - VAULT_SECRET_ENV=local
{% endif %}
{% if watchtower %}

  watchtower:
    env_file:
      - ops/overlays/local/.env
    environment:
      - WATCHTOWER_POLL_INTERVAL=0
      - REPO_USER=${REPO_USER:-}
      - REPO_PASS=${REPO_PASS:-}
    command: --scope local
{% endif %}
